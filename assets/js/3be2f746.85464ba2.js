"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[6078],{28453:(e,t,s)=>{s.d(t,{R:()=>l,x:()=>a});var n=s(96540);const i={},r=n.createContext(i);function l(e){const t=n.useContext(r);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),n.createElement(r.Provider,{value:t},e.children)}},68208:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"prelude/rules/erlang/erlang_escript","title":"erlang_escript","description":"erlang\\\\_escript","source":"@site/../docs/prelude/rules/erlang/erlang_escript.md","sourceDirName":"prelude/rules/erlang","slug":"/prelude/rules/erlang/erlang_escript","permalink":"/docs/prelude/rules/erlang/erlang_escript","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"ruleSidebar","previous":{"title":"erlang_app_includes","permalink":"/docs/prelude/rules/erlang/erlang_app_includes"},"next":{"title":"erlang_otp_binaries","permalink":"/docs/prelude/rules/erlang/erlang_otp_binaries"}}');var i=s(74848),r=s(28453);s(56289);const l={},a="erlang_escript",c={},d=[{value:"erlang_escript",id:"erlang_escript-1",level:2},{value:"Parameters",id:"parameters",level:4},{value:"Details",id:"details",level:4}];function o(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"erlang_escript",children:"erlang_escript"})}),"\n",(0,i.jsx)(t.h2,{id:"erlang_escript-1",children:"erlang_escript"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-python",children:'def erlang_escript(\n    *,\n    name: str,\n    default_target_platform: None | str = None,\n    target_compatible_with: list[str] = [],\n    compatible_with: list[str] = [],\n    exec_compatible_with: list[str] = [],\n    visibility: list[str] = [],\n    within_view: list[str] = ["PUBLIC"],\n    metadata: OpaqueMetadata = {},\n    tests: list[str] = [],\n    modifiers: OpaqueMetadata = [],\n    _apple_platforms: dict[str, str] = {},\n    _toolchain: str = "gh_facebook_buck2_shims_meta//:erlang-default",\n    configs: list[str] = [],\n    contacts: list[str] = [],\n    deps: list[str],\n    emu_args: list[str] = [],\n    include_priv: bool = False,\n    labels: list[str] = [],\n    main_module: None | str = None,\n    os_env: None | dict[str, str] = None,\n    resources: list[str] = [],\n    script_name: None | str = None,\n) -> None\n'})}),"\n",(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.code,{children:"erlang_escript"})," target builds and runs bundled escripts. Please refer to the ",(0,i.jsx)(t.a,{href:"https://www.erlang.org/doc/man/escript.html",children:"OTP documentation"})," for more details about escripts."]}),"\n",(0,i.jsx)(t.h4,{id:"parameters",children:"Parameters"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.code,{children:"name"}),": name of the target"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.code,{children:"default_target_platform"}),": specifies the default target platform, used when no platforms are specified on the command line"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.code,{children:"target_compatible_with"}),": a list of constraints that are required to be satisfied for this target to be compatible with a configuration"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.code,{children:"compatible_with"}),": a list of constraints that are required to be satisfied for this target to be compatible with a configuration"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.code,{children:"exec_compatible_with"}),": a list of constraints that are required to be satisfied for this target to be compatible with an execution platform"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.code,{children:"visibility"}),": a list of visibility patterns restricting what targets can depend on this one"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.code,{children:"within_view"}),": a list of visibility patterns restricting what this target can depend on"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.code,{children:"metadata"}),": a key-value map of metadata associated with this target"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.code,{children:"tests"}),": a list of targets that provide tests for this one"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.code,{children:"modifiers"}),": an array of modifiers associated with this target"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.code,{children:"configs"}),": This attribute allows to set config files for the escript. The dependencies that are typically used here are ",(0,i.jsx)(t.code,{children:"export_file"})," targets."]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.code,{children:"deps"}),": List of Erlang applications that are bundled in the escript. This includes all transitive dependencies as well."]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.code,{children:"emu_args"}),": This field specifies the emulator flags that the escript uses on execution. It is often desirable to specify the number of threads and schedulers the escript uses. Please refer to the ",(0,i.jsx)(t.a,{href:"https://www.erlang.org/doc/man/erl.html#emu_flags",children:"OTP documentation"})," for details."]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.code,{children:"include_priv"}),": Setting this flag, will package the applications ",(0,i.jsx)(t.code,{children:"priv"})," directory in the escript. Similar to files added through the ",(0,i.jsx)(t.code,{children:"resources"})," field, the ",(0,i.jsx)(t.code,{children:"priv"})," folders files can then be accessed by ",(0,i.jsx)(t.code,{children:'escript"extract/2'}),"."]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.code,{children:"main_module"}),": Overrides the default main module. Instead of deferring the main module from the scripts filename, the specified module is used. That module needs to export a ",(0,i.jsx)(t.code,{children:"main/1"})," function that is called as entry point."]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.code,{children:"os_env"}),": This attribute allows to set additional values for the operating system environment for invocations to the Erlang toolchain."]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.code,{children:"resources"}),": This adds the targets default output to the escript archive. To access these files, you need to use ",(0,i.jsx)(t.code,{children:"escript:extract/2"}),", which will extract the entire escript in memory. The relevant files can then be accessed through the ",(0,i.jsx)(t.code,{children:"archive"})," section."]}),"\n",(0,i.jsxs)(t.p,{children:["Please refer to the ",(0,i.jsx)(t.a,{href:"https://www.erlang.org/doc/man/escript.html",children:(0,i.jsx)(t.code,{children:"escript:extract/2"})})," for more details."]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.code,{children:"script_name"}),": Overrides the filename of the produced escript."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(t.h4,{id:"details",children:"Details"}),"\n",(0,i.jsxs)(t.p,{children:["Escripts by default always try to use the module that has the same name as the escripts basename as entry point, e.g. if\nthe escript is called ",(0,i.jsx)(t.code,{children:"script.escript"})," then running the escript will try to call ",(0,i.jsx)(t.code,{children:"script:main/1"}),". Both name and\nmain module can be overwritten though."]}),"\n",(0,i.jsxs)(t.p,{children:["The target name doubles as the default escript name. If the ",(0,i.jsx)(t.code,{children:"main_module"})," attribute is not used, the escript filename will\nbe ",(0,i.jsx)(t.code,{children:"<name>.escript"}),"."]}),"\n",(0,i.jsx)(t.p,{children:"Examples:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:'erlang_escript(\n    name = "script",\n    main_module = "main_module",\n    script_name = "the_script",\n    deps = [\n        ":escript_app",\n    ],\n    emu_args = ["+sbtu", "+A1"],\n)\n\nerlang_application(\n    name = "escript_app",\n    srcs = ["src/main_module.erl"],\n    applications = [\n        "kernel",\n        "stdlib",\n    ],\n)\n'})})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}}}]);